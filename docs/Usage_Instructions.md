# Usage Instructions for Propellant Selection Scripts

This document provides step-by-step instructions for using the scripts in this propellant selection project. The project helps select propellants for firearms based on internal ballistics calculations. We'll cover inputs, outputs, and plotting. Terms are explained simply for beginners.

## Inputs: What Data You Need and How to Provide It

### Required Data Files

The scripts need specific data to run calculations. Here's what's required:

 - **Cartridge Data**: Information about the cartridge, such as length, diameter, and bullet weight. This comes from GRT (Gordon's Reloading Tool) files, which are simulation outputs from ballistics software. Place these files in the `data/GRT_Files/` directory. Example: `65CM_140ELDM_RL16_44F.grtload`.

- **Propellant Parameters**: Details about different propellants, like burn rate and energy content. This is stored in `data/propellant_params.csv`. Ensure this file exists with columns for propellant name, burn rate, etc.

- **Derived Metrics (Optional)**: Some scripts use pre-calculated metrics from `data/derived_metrics.csv`, generated by other scripts in the project.

### How to Provide the Data

 1. **Download or Generate GRT Files**: Use ballistics software like QuickLOAD or GRT (Gordon's Reloading Tool) to simulate your cartridge. Export the load data to a `.grtload` file and place it in `data/GRT_Files/`.

2. **Prepare Propellant Data**: If not already present, create or obtain `data/propellant_params.csv` with propellant details. Each row represents a propellant type.

3. **Run Parsing Scripts First**: Before main calculations, parse the GRT files:
   - Run `python scripts/parse_grt_cartridge.py` to extract cartridge data into CSV.  
     Example CLI command: `python scripts/parse_grt_cartridge.py`
   - Run `python scripts/parse_grt_prop.py` to extract propellant data.  
     Example CLI command: `python scripts/parse_grt_prop.py`

   These generate `data/cartridge_data_from_grt.csv` and update propellant parameters.

Ensure all data files are in the `data/` directory before running other scripts.

## Interactive Demo

Use the Jupyter notebook (`jupyter/demo.ipynb`) for step-by-step execution of data processing, metrics calculation, and visualization in an integrated environment.

## Interpreting Outputs: What Each Script Produces and How to Understand It

The scripts perform calculations and save results as CSV files in `data/`. Each output helps evaluate propellants. Here's a breakdown with example CLI commands:

- **calculate_metrics.py**: Computes basic metrics like expansion ratio (a measure of how much space the bullet has to move in the barrel, affecting pressure and velocity) and propellant mass. Output: `data/calculated_metrics.csv`. Look for high expansion ratios for efficient burns.  
  Example CLI command: `python scripts/calculate_metrics.py`

- **compute_ba_eff.py**: Calculates ballistic efficiency (how effectively the propellant converts chemical energy into bullet kinetic energy). Output: `data/calculated_metrics.csv` (added columns). Higher efficiency means better performance.  
  Example CLI command: `python scripts/compute_ba_eff.py`

- **compute_predictions.py**: Predicts velocities and pressures based on models. Output: `data/Predictions.csv`. Compare predicted vs. actual values to validate.  
  Example CLI command: `python scripts/compute_predictions.py`

- **propellant_selector.py**: Recommends propellants based on criteria like desired velocity. Output: Console printouts or CSV with selections. Choose propellants that match your load goals.  
  Example CLI command: `python scripts/propellant_selector.py` (runs interactively)

- **create_db.py**: Builds a database of cartridge and propellant data. Output: Local database file. Use this for quick lookups.  
  Example CLI command: `python scripts/create_db.py`

- **analysis.py**: Performs overall analysis, combining metrics. Output: Various CSVs like `data/ExpansionRatio.csv`. Review for trends in performance.  
  Example CLI command: `python scripts/analysis.py`

To understand outputs:
- Open CSV files in Excel or a text editor.
- Key columns: Expansion ratio (higher = more efficient burn), velocity (ft/s), pressure (PSI), ballistic efficiency (%).
- Compare across propellants: Look for balanced metrics (high velocity, low pressure for safety).

## Creating Plots: How to Generate and Read Visualizations

Plots visualize data for easier interpretation. They are saved in `plots/` as PNG files. Run the scripts below to generate them.

### Generating Plots

Run these scripts to create visualizations:

- `python scripts/plot_data.py`: Generates general plots like predicted vs. actual velocities, expansion ratios, and propellant mass histograms.  
  Example CLI command: `python scripts/plot_data.py`

- `python scripts/plot_rc_bulletweight.py`: Plots recoil vs. bullet weight.  
  Example CLI command: `python scripts/plot_rc_bulletweight.py`

- `python scripts/plot_rc_sd.py`: Plots recoil vs. sectional density (bullet weight relative to caliber).  
  Example CLI command: `python scripts/plot_rc_sd.py`

These use data from CSVs, so run calculation scripts first.

### Reading the Plots

- **predicted_vs_actual.png**: Scatter plot of predicted vs. actual muzzle velocities. Points close to the diagonal line indicate accurate predictions.  
  ![Predicted vs Actual Charges](plots/predicted_vs_actual.png)

- **expansion_ratios.png**: Bar chart of expansion ratios by propellant. Higher bars mean more efficient gas expansion.  
  ![Expansion Ratios](plots/expansion_ratios.png)

- **propellant_mass_hist.png**: Histogram of propellant masses. Shows distribution for load consistency.  
  ![Propellant Mass Histogram](plots/propellant_mass_hist.png)

- **velocity_vs_barrel.png**: Velocity changes with barrel length. Helps optimize barrel design.  
  ![Velocity vs Barrel Length](plots/velocity_vs_barrel.png)

- **ba_eff_vs_sd_banded.png**: Ballistic efficiency vs. sectional density, banded by groups. Look for high-efficiency clusters.  
  ![BA Eff vs SD Banded](plots/ba_eff_vs_sd_banded.png)

- **rc_sd_ba_eff.png**, **rc_sd_banded.png**: Recoil vs. sectional density/efficiency. Lower recoil for comfortable shooting.  
  ![RC SD BA Eff](plots/rc_sd_ba_eff.png)  
  ![RC SD Banded](plots/rc_sd_banded.png)

- **rc_bulletweight.png**: Recoil vs. bullet weight plot.  
  ![RC Bullet Weight](plots/rc_bulletweight.png)

Interpret: Use plots to identify trends, like which propellants maximize velocity with minimal pressure. Consult ballistics guides for deeper insights.